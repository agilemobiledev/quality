@(
  user: com.gilt.quality.models.User,
  meeting: com.gilt.quality.models.Meeting,
  allItems: Seq[com.gilt.quality.models.AgendaItem],
  userTeams: Seq[com.gilt.quality.models.Team],
  userItems: Seq[com.gilt.quality.models.AgendaItem],
  otherItems: Seq[com.gilt.quality.models.AgendaItem]
)

<p>
  Dear @user.email,
</p>

<p>
  The Perfect Day meeting on @{core.DateHelper.mediumDateTime(meeting.organization, meeting.scheduledAt)}
  was adjourned at @{core.DateHelper.mediumDateTime(meeting.organization, meeting.adjournedAt.get)}. A
  meeting summary is below.
</p>

<h2>Meeting Summary</h2>

<ul>

  @com.gilt.quality.models.Task.all.map { task =>
    <li> # of incidents in @actors.Emails.taskLabel(task): @java.text.NumberFormat.getIntegerInstance.format(allItems.filter(_.task == task).size) </li>
  }
</ul>

<p>
  <a href="@lib.Email.qualityWebHostname/@meeting.organization.key/meetings/@meeting.id">View meeting details</a>
</p>

<h2>Team Assignments</h2>

<p>
  <b>Your teams</b>

  @if(userTeams.isEmpty) {
    <p>
      You are not currently a member of any teams. If you join a team,
      this email will highlight the specific incidents assigned to your
      teams.
    </p>
    <p>
      <a href="@lib.Email.qualityWebHostname/@meeting.organization.key/teams">View teams</a>
    </p>
  } else {
    @userItems.groupBy(_.incident.team).map { case (team, items) =>
      @meetingAdjournedTeamAssignment(meeting, team, items)
    }
  }
</p>

<p>
  <b>Other teams</b>

  @if(otherItems.isEmpty) {
    <p><em>There were no other team assignments</em></p>
  } else {
    @otherItems.filter(_.task == com.gilt.quality.models.Task.ReviewTeam).groupBy(_.incident.team).map { case (team, items) =>
      @meetingAdjournedTeamAssignment(meeting, team, items)
    }
  }
</p>

